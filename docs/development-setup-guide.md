# Development Setup Guide

## Prepare RMTLD3synth

### Cloning the Repository

Start by pulling the repository from GitHub using:

```sh
git clone --recursive https://github.com/anmaped/rmtld3synth.git
```

### Setting Up Visual Studio Code

1.  Open **Visual Studio Code** and download the extension **"Dev Containers"**.
2.  Navigate to **"Remote Explorer"**, click **"New Dev Container"**, and add the folder created when pulling the repository.
3.  You should now have access to the repository and all files through **Visual Studio Code**.

### Running Configuration Commands

Open a terminal and run the following commands:

```sh
./configure           # configure before compilation
make                  # compile the tool
make tests allchecks  # test the compiled tool
```

This will configure the tool, compile it, and run a series of tests to help you understand how it works.

> **Note:** If the latest container version was not pulled, it might be necessary to run the following command before executing `make`:

```sh
opam install ppx_yojson_conv
```

### Running the Tool

Your environment is now completely functional. You can start testing the tool using the `rmtld3synth` command.


## Monitor Demonstration (OCaml)

### Prepare the dependent files for the test demonstration

To compile, we will use an already generated monitor:

-   `res1.ml` (this file is generated by the tool when running the `make tests`),
-   `rmtld3_eval.ml` (containing the evaluation functions).

We can compile other tests simply by copying the corresponding `resX.ml` file. See `unittests/test.sh` for more examples.

To manually compile one of our generated tests, follow these steps:

```sh
cd demonstration
cp /workspaces/_build_tests/_alltests/res1.ml .
touch test.ml
``` 

Now, write the `test.ml` file with the following content:

```
open Res1
module T1 : Trace = struct let trc = [ ("p",(0.));  ("p",(1.));  ("p",(2.)); ] end;;
module M1 = Res1.Res1_0(T1);;
print_string "1) ";;
if M1.mon = Rmtld3_eval.True then print_endline ("\x1b[32m[true]\x1b[0m") 
else (if M1.mon = Rmtld3_eval.False then print_endline ("\x1b[31m[false\x1b[0m")
else print_endline ("\x1b[33m[unknown]\x1b[0m"))
```

Next, copy the required evaluation dependency file:

```sh
cp /workspaces/src/rmtld3_eval.ml .
``` 

Compile and execute:

```sh
ocamlc -o demo rmtld3_eval.ml res1.ml test.ml
./demo
```

## Generating Monitors with RMTLD3synth (OCaml)

The files evaluated above are all created by **RMTLD3synth**. To generate a custom one, use the following command:

```sh
rmtld3synth --synth-ocaml --input-dsl "a until b within 10s" --out-src demonstration
```

This creates a monitor in **OCaml** for the `"a until b within 10s"` expression. You can modify this to synthesize monitors for other expressions as needed.
